<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>관리자 주문관리</title>
  <link rel="stylesheet" href="/css/site.css">
</head>
<body>
<div th:replace="fragments :: topbar"></div>
<main class="container grid">
  <div class="message error" th:if="${errorMessage}" th:text="${errorMessage}"></div>
  <div class="message success" th:if="${successMessage}" th:text="${successMessage}"></div>

  <section class="panel">
    <h3>주문 관리</h3>
    <p class="meta">MVP 단계에서는 상태 변경/피킹 전 취소 정책을 수동 처리합니다.</p>
  </section>

  <section class="table-wrap">
    <table>
      <thead>
      <tr>
        <th>주문번호</th>
        <th>고객</th>
        <th>현재상태</th>
        <th>예상총액</th>
        <th>상태변경</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="order : ${orders}">
        <td th:text="${order.order_no}"></td>
        <td th:text="${order.customer_name} + ' / ' + ${order.customer_phone}"></td>
        <td><strong th:text="${order.status}"></strong></td>
        <td th:text="${#numbers.formatDecimal(order.total_estimated, 0, 'COMMA', 0, 'POINT')} + '원'"></td>
        <td>
          <form class="grid" style="grid-template-columns:1fr 1fr auto;gap:6px;" th:action="@{/admin/orders/{id}/status(id=${order.id})}" method="post">
            <select name="status">
              <option th:each="st : ${statuses}" th:value="${st}" th:text="${st}" th:selected="${st == order.status}"></option>
            </select>
            <input name="reason" placeholder="사유(선택)">
            <button type="submit">적용</button>
          </form>
        </td>
      </tr>
      </tbody>
    </table>
  </section>
</main>
</body>
</html>
